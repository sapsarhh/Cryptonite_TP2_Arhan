# Binary Exploitation
## buffer overflow 0
## Flag
~~~
bash
picoCTF{ov3rfl0ws_ar3nt_that_bad_9f2364bc}
~~~
Step 1:
Before buffer overflow 0 I tried some easy challenges of binary exploitation such as heap 0.
Code and Terminal Output
~~~
nc saturn.picoctf.net 60203saps@LAPTOP-KKUS7K8J:~$ nc saturn.picoctf.net 60203
Input: man gets
The program will exit now
jejwijkepoekpknewkpwemlpewmnwkekpnkem
saps@LAPTOP-KKUS7K8J:~$ nc saturn.picoctf.net 60203
Input: jejwijkepoekpknewkpwemlpewmnwkekpnkemeu8eu9jiejoknidjoxok33
picoCTF{ov3rfl0ws_ar3nt_that_bad_9f2364bc}
~~~
Learnings
A) Now as I stated above before this I tried my hands on the easy challenges such as heap 0, so keeping the learnings which I learnt in heap 0 in mind, I tried this the same way.
Firstly I launched the instance as well as checked out the source code.
When the source code opened I saw that the string buf2 can only be maximum 16 characters and if I input more than 16 letters that data would overflow and the behaviour of the program would be manipulated and the flag might be printed.
That is exactly what happened here and the flag got printed when I entered a string with excessive letters.
B) Now this is how I related it to heap 0 and could do it so quickly, because in heap 0 i tried and tested alot and after checking out the source code I realized that in that as well after printing some choice I had to overflow the data so it could into the safe variable and print me the flag.
Other Methods
I only tried entering man gets, i dont know why I did that as that was given to me in the hint section but that wouldnt do anything as the man page cannot be printed out in this instance, everything else I learnt in heap 0.

![image](https://github.com/user-attachments/assets/0c919a2a-7e32-46fa-8a66-f9627747217a)

References:
No references used per say other than the videos provided in the document itself under binary exploitation.


## format string 0
## Flag
~~~
bash
picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_f89c1405}
~~~

Step 1:
Same as the above question I had to check out the source code firstly and then I got to know that I had to input Gr%114d_Cheese which contains a format string %ll4d and is the only format string out of the 3 options.
Step 2:
That worked out and then I had to choose between 3 options again, and again only one string consisted of %s which is a string formatter and that worked and gave me the flag.

![image](https://github.com/user-attachments/assets/0308450f-aa37-42d5-8d96-e247c8739b3f)

Code and Terminal Output:
~~~
bash
 nc mimas.picoctf.net 58514
Welcome to our newly-opened burger place Pico 'n Patty! Can you help the picky customers find their favorite burger?
Here comes the first customer Patrick who wants a giant bite.
Please choose from the following burgers: Breakf@st_Burger, Gr%114d_Cheese, Bac0n_D3luxe
Enter your recommendation: Gr%114d_Cheese
Gr                                                                                                           4202954_Cheese
Good job! Patrick is happy! Now can you serve the second customer?
Sponge Bob wants something outrageous that would break the shop (better be served quick before the shop owner kicks you out!)
Please choose from the following burgers: Pe%to_Portobello, $outhwest_Burger, Cla%sic_Che%s%steak
Enter your recommendation: Cla%sic_Che%s%steak
ClaCla%sic_Che%s%steakic_Che(null)
picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_f89c1405}
~~~


Learnings:
A) already knew about string formatters which were %lld and %s and using that concept got the flag.

References:
https://www.youtube.com/watch?v=CRTR5ljBjPM&ab_channel=LowLevel
watched the above video which didnt really have anything to do with the above challenge but still.



## flag leak
## Flag:
picoCTF{L34k1ng_Fl4g_0ff_St4ck_95f60617}

Step 1:
In the question, I was given a source code and a server to connect to through the terminal.
On connecting to the server it told me to tell it a story, on which if I typed anything it would just echo the input back to me.

Step 2:
Opened the source code and saw that the story variable was allocated 127 characters, hence I tried to enter more than 127 characters to create a buffer overflow which didnt work here.

Step 3:
I was highly confused looking at the source code so I checked the hint which said format strings.
That is when it hit me, I checked the source code again and noticed that there was no prevention against entering format string specifiers such as %s or %x(I asked chatgpt this and told me there was no prevention).

Step 4:
Firstly I tried to enter %s characters which gave me nothing only a blank.
That is when I entered %x and noticed that there were random hexadecimal characters returned back to me.
~~~
bash
Tell me a story and then I'll tell you one >> %x
Here's a story -
ff997aa0
~~~
I tried converting this ascii readable text which led to no useful output.
That is when I tried multiple %x characters to confirm whether it would give me more hexadecimal values or not and of course it did.
~~~
bash
Tell me a story and then I'll tell you one >> %x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x
Here's a story -
ffe26bb0ffe26bd080493467825782578257825782578257825782578257825782578257825782578257825782578257825782578257825782578257825782578257825782578257825782578257825782578257825782578257825ffe26c00e97a1b50e976d410110e976d4101e97a10008048338e9765d20e95eaab06f6369707b4654436b34334c5f676e3167346c46
e
~~~

Step 5:
Now when I converted this it gave me this output:
![image](https://github.com/user-attachments/assets/8c1e5e4b-3e81-428c-bc43-ce44f3b58c69)

Now I noticed that the flag format was right there but firstly it wasnt complete and secondly it was of course jumbled up.
So I decided to double down and entered alot of %x format strings, that is when I got this:

![image](https://github.com/user-attachments/assets/17560619-7b10-477c-a7af-fe90f0578272)

Now I got the complete flag and only had to unjumble it, did that and got the flag.

Learnings:
Probably one of the most toughest challenges on pico, as it was not completely obvious like the other 2 binary exp challenges.
1) Learnt on how to deal with special format specifiers like strings in this case.
2) Learnt how to check all the possible hex values which might fetch some result

References:
https://gchq.github.io/CyberChef/#recipe=From_Hex('Auto')&input=ZmM5ZGVmMGZmYzlkZjEwODA0OTM0Njc4MjU3ODI1NzgyNTc4MjU3ODI1NzgyNTc4MjU3ODI1NzgyNTc4MjU3ODI1NzgyNTc4MjU3ODI1NzgyNTc4MjU3ODI1NzgyNTc4MjU3ODI1NzgyNTc4MjU3ODI1NzgyNTc4MjU3ODI1NzgyNTc4MjU3ODI1NzgyNTc4MjU3ODI1NzgyNTc4MjU3ODI1NzgyNTc4MjU3ODI1NzgyNTc4MjU3ODI1NzgyNTI1NzgyNTc4Nzg3ODI1Nzg3ODI1NzgyNTI1Nzg3ODI1MjU3ODI1Nzg3ODI1Nzg3ODc4MjU3ODI1MjU3ODI1Nzg3ODc4MjU3ODc4MjU3ODI1ZjEwMDc4MjU2ZjYzNjk3MDdiNDY1NDQzNmIzNDMzNGM1ZjY3NmUzMTY3MzQ2YzQ2NjY2NjMwNWYzNDc0NTM1ZngzOTVmNmI2MzMwMzY2NjM1N2QzNzMxMzZ4ZmJhZDIwMDA4MDM4MzUwMDB4ZjFhMTQ5OTA4MDRjMDAwODA0OTQxMHgwODA0YzAwMGZmYzlkZmQ4eDgwNDk0MTgyZmZjOWUwODR4ZmZjOWUwOTAwZmZjOWRmZjA&ieol=CRLF


Incorrect Methods:
1) Did alot of hit and trial on the format string specifiers and also the jumbling of the flag.
2) Tried to buffer overflow the flag variable.





